var Y=Object.defineProperty;var P=i=>{throw TypeError(i)};var Z=(i,t,s)=>t in i?Y(i,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[t]=s;var r=(i,t,s)=>Z(i,typeof t!="symbol"?t+"":t,s),I=(i,t,s)=>t.has(i)||P("Cannot "+s);var h=(i,t,s)=>(I(i,t,"read from private field"),s?s.call(i):t.get(i)),p=(i,t,s)=>t.has(i)?P("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(i):t.set(i,s),C=(i,t,s,e)=>(I(i,t,"write to private field"),e?e.call(i,s):t.set(i,s),s),S=(i,t,s)=>(I(i,t,"access private method"),s);class o{static isType(t,s){return Object.prototype.toString.call(t)===`[object ${s}]`}static isNumber(t){return this.isType(t,"Number")&&!Number.isNaN(t)}static isString(t){return this.isType(t,"String")}static isBoolean(t){return this.isType(t,"Boolean")}static isArray(t){return this.isType(t,"Array")}static isObject(t){return this.isType(t,"Object")}static isRegExp(t){return this.isType(t,"RegExp")}static isUndefined(t){return this.isType(t,"Undefined")}static isNull(t){return this.isType(t,"Null")}static degreesToRadians(t){return t*Math.PI/180}static radiansToDegrees(t){return(t*(180/Math.PI)+360)%360}static parseBinary(t){return parseInt(t,2)}static toBinaryString(t){return t.toString(2)}static formatNumber(t){return typeof t=="number"?parseFloat(t.toFixed(4)):t}static formatStringOrBoolean(t){return typeof t=="string"||typeof t=="boolean"?t.toString().toUpperCase():t}static objectFormat(t){const s={};for(let e in t){const n=t[e];this.isObject(n)?s[e]=this.objectFormat(n):(this.isNumber(n)&&(s[e]=o.formatNumber(n)),(this.isString(n)||this.isBoolean(n))&&(s[e]=o.formatStringOrBoolean(n)))}return s}static deepCopy(t){if(this.isNull(t)||!this.isObject(t))return t;let s=this.isArray(t)?[]:{};for(let e in t)s[e]=this.deepCopy(t[e]);return s}static intersection(...t){return t.reduce((s,e)=>s.filter(n=>e.includes(n)))}static union(...t){return[...new Set(t.reduce((s,e)=>s.concat(e),[]))]}static difference(...t){const[s,...e]=t;return s.filter(n=>!e.some(d=>d.includes(n)))}}class a{constructor(t){r(this,"x");r(this,"y");if(this.isXZInput(t))this.x=t.z,this.y=t.x/2;else if(this.isXYInput(t))this.x=t.x,this.y=t.y;else throw new Error(`${this.constructor.name}，Point assignment error: Invalid object structure. Current object is: ${JSON.stringify(t)}`);this.x=o.formatNumber(this.x),this.y=o.formatNumber(this.y)}isXYInput(t){return"y"in t}isXZInput(t){return"z"in t}add(t){return new a({x:this.x+t.x,y:this.y+t.y})}sub(t){return new a({x:this.x-t.x,y:this.y-t.y})}div(t){if(t===0)throw new Error(`${this.constructor.name}，Division by zero`);return new a({x:this.x/t,y:this.y/t})}mul(t){return new a({x:this.x*t,y:this.y*t})}toLathePoint(){return{x:o.formatNumber(this.y*2),z:this.x}}toLatheAxisPrint(t=" "){const{x:s,z:e}=this.toLathePoint();return`X${s}${t}Z${e}`}print(t=" "){return`${this.x}${t}${this.y}`}toAxisPrint(t=" "){return`X${this.x}${t}Y${this.y}`}}var m,R,x,$,q;class k{constructor(t={}){p(this,$);r(this,"tolerance");p(this,m);p(this,R);p(this,x);r(this,"maximum");r(this,"nominal");r(this,"minimum");const{tolerance:s="62 0.05 -0.05"}=t;this.tolerance=s,S(this,$,q).call(this)}}m=new WeakMap,R=new WeakMap,x=new WeakMap,$=new WeakSet,q=function(){const t=this.tolerance.split(" ").filter(s=>s).map(s=>parseFloat(s));C(this,m,t.at(0)||0),C(this,R,t.at(1)||0),C(this,x,t.at(2)||0),this.maximum=h(this,m)+h(this,R),this.nominal=h(this,m)+(h(this,R)+h(this,x))/2,this.minimum=h(this,m)+h(this,x)};var O,D;class H{constructor(t={}){p(this,O);r(this,"toolRadius");r(this,"value");r(this,"type");r(this,"u");r(this,"w");const{toolRadius:s=.4,value:e=1,type:n="chamfer"}=t;this.toolRadius=s,this.value=e,this.type=n,S(this,O,D).call(this)}}O=new WeakSet,D=function(){this.type==="chamfer"?(this.w=this.value+T.getCrcLength(this.toolRadius,45),this.u=this.w*2):this.type==="radius"&&(this.w=this.value+this.toolRadius,this.u=this.w*2)};var M,F;class X{constructor(t={}){p(this,M);r(this,"sideLengthA");r(this,"sideLengthB");r(this,"sideLengthC");r(this,"angle");r(this,"sideLengthACRC");r(this,"sideLengthBCRC");r(this,"toolRadius");const{angle:s=0,sideLengthA:e=0,sideLengthB:n=0,sideLengthC:d=0}=t;if(this.angle=s,this.sideLengthA=e,this.sideLengthB=n,this.sideLengthC=d,!this.valid())throw new Error(`${this.constructor.name}，Invalid parameters: ${JSON.stringify({angle:s,sideLengthA:e,sideLengthB:n,sideLengthC:d})}`);S(this,M,F).call(this)}valid(){const t=e=>o.isNumber(e)&&e>0;return[this.angle,this.sideLengthA,this.sideLengthB,this.sideLengthC].filter(e=>t(e)).length===2}getSideLengthA(){return L.sqrt(this.sideLengthC**2-this.sideLengthB**2)}getSideLengthB(){return L.sqrt(this.sideLengthC**2-this.sideLengthA**2)}getSideLengthC(){return L.sqrt(this.sideLengthA**2+this.sideLengthB**2)}}M=new WeakSet,F=function(){this.angle?this.sideLengthA?(this.sideLengthB=this.sideLengthA*L.tan(this.angle),this.sideLengthC=this.getSideLengthC()):this.sideLengthB?(this.sideLengthA=this.sideLengthB/L.tan(this.angle),this.sideLengthC=this.getSideLengthC()):this.sideLengthC&&(this.sideLengthA=this.sideLengthC*L.cos(this.angle),this.sideLengthB=this.getSideLengthB()):(this.sideLengthA&&this.sideLengthB?this.sideLengthC=this.getSideLengthC():this.sideLengthA&&this.sideLengthC?this.sideLengthB=this.getSideLengthB():this.sideLengthB&&this.sideLengthC&&(this.sideLengthA=this.getSideLengthA()),this.angle=L.acos(this.sideLengthA/this.sideLengthC))};var v,U;const E=class E extends X{constructor(s={}){super(s);p(this,v);const{toolRadius:e=0,angle:n,sideLengthA:d,sideLengthB:u,sideLengthC:g}=s;if(e<0)throw new Error(`${this.constructor.name}，当前值：toolRadius = ${e}，取值范围：toolRadius > 0`);this.toolRadius=e,S(this,v,U).call(this)}static getCrcLength(s,e){return s*(1-L.tan(e/2))}};v=new WeakSet,U=function(){if(!this.angle)throw new Error(`${this.constructor.name}，Triangle angle must be set before calculating CRC.`);this.sideLengthACRC=E.getCrcLength(this.toolRadius,this.angle),this.sideLengthBCRC=E.getCrcLength(this.toolRadius,90-this.angle)};let T=E;class j{constructor({quadrant:t="第一象限",pointC:s=new a({x:100,z:0}),angle:e=45,value:n=1,direction:d="逆时针",position:u="外侧",toolRadius:g=.4}={}){r(this,"quadrant");r(this,"pointC");r(this,"angle");r(this,"value");r(this,"direction");r(this,"position");r(this,"toolRadius");r(this,"pointA");r(this,"pointB");this.quadrant=t,this.pointC=s,this.angle=e,this.value=n,this.direction=d,this.position=u,this.toolRadius=g}}var N,f;class K extends j{constructor(s={}){const{quadrant:e="第一象限",pointC:n=new a({x:100,z:0}),angle:d=45,value:u=1,direction:g="逆时针",position:y="外侧",toolRadius:B=.4}=s;super(s);p(this,N);r(this,"radius");r(this,"radiusCRC");p(this,f);this.radius=d===45?this.value:void 0,C(this,f,new X({angle:d,sideLengthA:u})),C(this,N,{第一象限:{pointA:new a({x:-(h(this,f).sideLengthA*2),z:0}),pointB:new a({x:0,z:-h(this,f).sideLengthB})},第四象限:{pointA:new a({x:0,z:-h(this,f).sideLengthB}),pointB:new a({x:h(this,f).sideLengthA*2,z:0})},第二象限:{pointA:new a({x:0,z:h(this,f).sideLengthB}),pointB:new a({x:-(h(this,f).sideLengthA*2),z:0})},第三象限:{pointA:new a({x:h(this,f).sideLengthA*2,z:0}),pointB:new a({x:0,z:h(this,f).sideLengthB})}});const l=this.calc();this.pointA=l.pointA,this.pointB=l.pointB,this.radiusCRC=l.radiusCRC}calc(){const s=this.toolRadius!==0,e=this.position==="外侧",n=this.direction==="顺时针",d=s?this.toolRadius:0,u=e?1:-1,g=h(this,N)[this.quadrant],y=g.pointA.mul(d*u),B=g.pointB.mul(d*u),l=new a(this.pointC).add(g.pointA).add(y),z=new a(this.pointC).add(g.pointB).add(B),A=this.radius??0,w=s?e?A+this.toolRadius:A-this.toolRadius:A;return n?{pointA:z,pointB:l,radiusCRC:w}:{pointA:l,pointB:z,radiusCRC:w}}}N=new WeakMap,f=new WeakMap;var b,c;class V extends j{constructor(s={}){const{quadrant:e="第一象限",pointC:n=new a({x:100,z:0}),angle:d=45,value:u=1,direction:g="逆时针",position:y="外侧",toolRadius:B=.4}=s;super(s);p(this,b);r(this,"chamfer");r(this,"chamferCRC");p(this,c);this.chamfer=this.angle===45?this.value:null,C(this,c,new T({toolRadius:B,angle:d,sideLengthA:u})),C(this,b,{第一象限:{pointA:new a({x:-(h(this,c).sideLengthA*2),z:0}),pointB:new a({x:0,z:-h(this,c).sideLengthB})},第四象限:{pointA:new a({x:0,z:-h(this,c).sideLengthB}),pointB:new a({x:h(this,c).sideLengthA*2,z:0})},第二象限:{pointA:new a({x:0,z:h(this,c).sideLengthB}),pointB:new a({x:-(h(this,c).sideLengthA*2),z:0})},第三象限:{pointA:new a({x:h(this,c).sideLengthA*2,z:0}),pointB:new a({x:0,z:h(this,c).sideLengthB})}});const l=this.calc();this.pointA=l.pointA,this.pointB=l.pointB,this.chamferCRC=l.chamferCRC}calc(){const s=this.toolRadius!==0,e=this.position==="外侧",n=this.direction==="顺时针",d=s?1:0,u={sideLengthACRC:h(this,c).sideLengthACRC*d,sideLengthBCRC:h(this,c).sideLengthBCRC*d},g=e?1:-1,{pointA:y,pointB:B}=h(this,b)[this.quadrant],l=y.mul(u.sideLengthACRC*g),z=B.mul(u.sideLengthBCRC*g),A=new a(this.pointC).add(y).add(l),w=new a(this.pointC).add(B).add(z);return this.chamferCRC=(this.chamfer||void 0)+T.getCrcLength(this.toolRadius,45)*g,n?{pointA:w,pointB:A,chamferCRC:this.chamferCRC}:{pointA:A,pointB:w,chamferCRC:this.chamferCRC}}}b=new WeakMap,c=new WeakMap;const G={"+":(i,t)=>i+t,"-":(i,t)=>i-t,"*":(i,t)=>i*t,"/":(i,t)=>i/t,EQ:(i,t)=>i===t,NE:(i,t)=>i!==t,GT:(i,t)=>i>t,GE:(i,t)=>i>=t,LT:(i,t)=>i<t,LE:(i,t)=>i<=t,AND:(i,t)=>o.toBinaryString(o.parseBinary(i)&o.parseBinary(t)),OR:(i,t)=>o.toBinaryString(o.parseBinary(i)|o.parseBinary(t)),XOR:(i,t)=>o.toBinaryString(o.parseBinary(i)^o.parseBinary(t)),NOT:i=>o.toBinaryString(~o.parseBinary(i)),SIN:i=>Math.sin(o.degreesToRadians(i)),COS:i=>Math.cos(o.degreesToRadians(i)),TAN:i=>Math.tan(o.degreesToRadians(i)),ASIN:i=>o.radiansToDegrees(Math.asin(i)),ACOS:i=>o.radiansToDegrees(Math.acos(i)),ATAN:i=>o.radiansToDegrees(Math.atan(i)),SQRT:i=>Math.sqrt(i),ABS:i=>Math.abs(i),ROUND:i=>Math.round(i),EXP:i=>Math.exp(i),LN:i=>Math.log(i),FIX:i=>Math.floor(i),FUP:i=>Math.ceil(i),B2D:i=>o.parseBinary(i).toString(),D2B:i=>o.toBinaryString(i*1)},J={get(i,t){const s=t.toUpperCase();return(...e)=>{if(!(s in i))throw new Error(`${this.constructor.name}，Operation ${s} is not defined.`);const n=i[s](...e);return typeof n=="number"?o.formatNumber(n):typeof n=="string"||typeof n=="boolean"?o.formatStringOrBoolean(n):n}}},L=new Proxy(G,J);export{H as C,L as M,a as P,K as R,k as T,o as U,V as a};
